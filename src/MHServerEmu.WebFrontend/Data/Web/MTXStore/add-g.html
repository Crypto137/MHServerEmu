<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Add G</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
	
	<style>
		html {
			background-color: #0d0d0b;
			color: #d7d7d7;
			font: 18px/1.385 Verdana;
		}

		*:focus {
			outline-color: #00e8ff;
		}

		h1, h2, h3, h4, h5, h6 {
			color: #00aaff;
			font-family: "Bebas Neue", "Trebuchet MS", Verdana, sans-serif;
			font-weight: normal;
		}

		button, input {
			width: 100%;
			box-sizing: border-box;
			border: 1px solid black;
			box-shadow: 0 0 1px 1px #00aaff;
			background: #1c1c1c;
			color: inherit;
			font: inherit;
		}

		button:hover {
			box-shadow: 0 0 1px 1px white;
		}

		input {
			width: 100%;
			text-align: center;
		}

		input[type="range"] {
			margin: 4px 0px;
		}

		input::-webkit-slider-thumb {
			-webkit-appearance: none;
			width: 26px;
			height: 26px;
			background: #00aaff;
		}

		table {
			width: 100%;
			margin: 12px 0px;
			border-spacing: 4px;
		}

		div.content {
			margin: 10px auto;
			padding: 20px;
			border: 1px solid #00717c;
			background-color: #00090e;
		}

		div.button-container {
			display: flex;
			justify-content: center;
		}

		div.button-container button {
			width: 50%;
			margin: 0px 8px;
			padding: 8px;
		}
	</style>
</head>
<body>
	<div class="content">
		<h1>Add G</h1>
		<p>Select the amount of Eternity Splinters to convert to G.</p>
		<table>
			<tr>
				<th style="width: 60px;">ES</th>
				<th style="width: 28px;"></th>
				<th></th>
				<th style="width: 28px;"></th>
				<th style="width: 60px;">G</th>
			</tr>
			<tr>
				<td><input type="text" value="0" id="es-text-input" onchange="setES(this.value)" /></td>
				<td><button onclick="adjustES(-1)" class="sign-button">-</button></td>
				<td><input type="range" value="0" min="0" max="100" step="1" id="es-range-input" onchange="setES(this.value)" /></td>
				<td><button onclick="adjustES(1)" class="sign-button">+</button></td>
				<td><input type="text" value="0" id="g-text-input" onchange="setESFromG(this.value)" /></td>
			</tr>
		</table>
		<p>Please note that the amount of G after conversion is subject to rounding errors.</p>
		<div class="button-container">
			<button onclick="convert()">Convert</button>
			<button onclick="myApi.CloseAddGPanel(false)">Close</button>
		</div>
	</div>

	<script>
		var requestContext = Object.freeze({
			downloader: "%REQUEST_DOWNLOADER%",
			token: "%REQUEST_TOKEN%",
			email: "%REQUEST_EMAIL%",
			currentBalance: "%REQUEST_CURRENT_BALANCE%",
			conversionRatio: "%REQUEST_CONVERSION_RATIO%",
		});

		function getES() {
			return Number(document.getElementById("es-range-input").value);
		}

		function setES(esAmount) {
			esAmount = Math.max(Math.min(esAmount, requestContext.currentBalance), 0);
			if (isNaN(esAmount))
				esAmount = 0;

			document.getElementById("es-range-input").value = esAmount;
			document.getElementById("es-text-input").value = esAmount;
			document.getElementById("g-text-input").value = Math.floor(esAmount * requestContext.conversionRatio);
		}

		function setESFromG(gAmount) {
			var esAmount = Math.ceil(gAmount / requestContext.conversionRatio);
			setES(esAmount);
		}

		function adjustES(delta) {
			setES(getES() + delta);
		}

		function convert() {
			window.alert('not yet implemented');
		}

		document.getElementById("es-range-input").max = requestContext.currentBalance;
	</script>
</body>
</html>